jQuery(document).ready(function(e){function t(t){var a=t.data("scope"),s={},n=!0;e("#"+a+" .edit-field").each(function(){""==e(this).val()&&"change-password"!=e(this).attr("id")?(e(this).addClass("error"),n=!1):e(this).removeClass("error"),s[e(this).attr("id")]=e(this).val()}),n&&(t.html("Edit"),e("#cancel-edit-profile").remove(),e.ajax({type:"POST",cache:!1,url:ajaxurl+"?action=update_user",data:s,success:function(){e("#editProfile").html("Edit")}}),i("edit",a))}function a(){e("#new_user").trigger("reset"),e("child-users").html('<img src="/library/images/general/ajax-loader.gif" class="" alt="">'),e("#child-users").load("/dashboard/my-details/ #current-users",function(t,a,i){"error"==a&&e("#error").html(msg+i.status+" "+i.statusText),e("#child-users").goTo(),e("#add-button").removeAttr("disabled")})}function i(t,a){e(".cancel-edit-profile").remove(),e("#edit-profile").html("Edit"),e("#"+a+" .edit-field").each(function(){"password"==e(this).attr("type")?e(this).parent().html("*********"):"edit"==t?e(this).parent().html(e(this).val()):e(this).parent().html(e(this).data("original"))})}e(document).on("click",".save-webinars",function(t){t.preventDefault(),e(".save-webinars").attr("disabled","disabled");var a=e(this).data("counter");e.ajax({type:"POST",url:ajaxurl+"?action=assign_users_to_webinar",data:e("#purchase-"+a).serialize(),success:function(t){if("true"!=e.trim(t));else{var a=e(".dash-btns .silver").data("uri");e("#my-purchases").load(a+" #dash-main",function(){})}}})}),e(document).on("click",".save-conferences",function(t){t.preventDefault(),e(".save-conferences").attr("disabled","disabled");var a=e(this).data("counter");e.ajax({type:"POST",url:ajaxurl+"?action=assign_users_to_conference",data:e("#purchase-"+a).serialize(),success:function(t){if("true"!=e.trim(t));else{var a=e(".dash-btns .silver").data("uri");e("#my-purchases").load(a+" #dash-main",function(){})}}})}),e(document).on("click",".save-workshops",function(t){t.preventDefault(),e(".save-workshops").attr("disabled","disabled");var a=e(this).data("counter");e.ajax({type:"POST",url:ajaxurl+"?action=assign_users_to_workshop",data:e("#purchase-"+a).serialize(),success:function(t){if("true"!=e.trim(t));else{var a=e(".dash-btns .silver").data("uri");e("#my-purchases").load(a+" #dash-main",function(){})}}})}),e(document).on("keypress",".edit-field",function(a){13==a.which&&t(e("#editProfile"))}),e(document).on("click",".inline-edit",function(a){a.preventDefault();var i=e(this).html();if("Edit"==i){e(this).html("Save");var s=e(this).data("scope");e(this).parent().append('<a href="" class="edit-prof gen-btn cancel-btn" id="cancel-edit-profile" data-scope="'+s+'" >Cancel</a>'),e("#"+s+" .editable").each(function(){var t="",a="",i=e.trim(e(this).html()),s="text";e(this).data("type")&&(s=e(this).data("type")),"password"==e(this).data("type")&&(i=""),t="textarea"!=s?'<input type="'+s+'" id="change-'+e(this).data("id")+'" data-original="'+i+'" class="edit-field" value="'+i+'" />':'<textarea id="change-'+e(this).data("id")+'" data-original="'+i+'" class="edit-field">'+i+"</textarea>",e(this).data("label")&&(a='<label for="change-'+e(this).data("id")+'">'+e(this).data("label")+"</label>"),e(this).html(a+" "+t)})}"Save"==i&&t(e(this))}),e(document).on("click","#cancel-edit-profile",function(t){t.preventDefault(),e("#editProfile").html("Edit");var a=e(this).data("scope");e(this).remove(),i("cancel",a)}),e(document).on("submit","#new_user",function(t){t.preventDefault(),e("#add-button").attr("disabled","disabled");var i=!0;e("#new_first_name").removeClass("error"),e("#new_last_name").removeClass("error"),e("#new_email").removeClass("error"),(""==e("#new_first_name").val()||""==e("#new_last_name").val()||""==e("#new_email").val())&&(i=!1,""==e("#new_first_name").val()&&e("#new_first_name").addClass("error"),""==e("#new_last_name").val()&&e("#new_last_name").addClass("error"),""==e("#new_email").val()&&e("#new_email").addClass("error")),i?e.ajax({type:"POST",url:ajaxurl+"?action=create_user",data:e("#new_user").serialize(),success:function(e){"true"!=e?alert("Couldn't create useraccount"):a()}}):e("#add-button").removeAttr("disabled")}),e("#international").on("submit",function(t){t.preventDefault(),e.ajax({type:"POST",url:ajaxurl+"?action=international",data:e("#international").serialize(),success:function(e){alert(e)}})}),e(".edit-inline").on("click",function(){var t=e(this).data("scope");e("#"+t+" .editable").each(function(){e(this).css("display","none")}),e("#"+t+" .editable-h").each(function(){e(this).css("display","")})}),e(".cancel-inline").on("click",function(){var t=e(this).data("scope");e("#"+t+" .editable-h").each(function(){e(this).css("display","none")}),e("#"+t+" .editable").each(function(){e(this).css("display","")})}),e(".save-inline").on("click",function(){{var t=e(this).data("scope"),a=e(this).data("action");e(this)}e("#"+t+" .editable-h").each(function(){var t=e(this).children(":first");if(t.is("input"))t.is("input:text")||t.is("input:email")?e(this).next().html(t.val()):t.is("input:password")&&e(this).next().html("*****");else if(t.is("textarea"))e(this).next().html(t.val());else if(t.is("select"))e(this).next().html(t.val());else if(t.is("ul")){var a="";e("#"+t.attr("id")+" input:checkbox").each(function(){e(this).prop("checked")&&(a=a+"<li>"+e(this).val()+"</li>")}),e(this).next().children(":first").html(a)}e(this).css("display","none")}),e("#"+t+" .editable").each(function(){e(this).css("display","")});var i=e("#"+a).serialize();e.ajax({type:"POST",cache:!1,url:ajaxurl+"?action="+a,data:i,success:function(e){alert(e)}})}),e(".delete-cpd").on("click",function(t){if(t.preventDefault(),confirm("do you really want to delete this?")){var a={};a["cpd-log-id"]=e(this).data("cpd-id"),e.ajax({type:"POST",cache:!1,url:ajaxurl+"?action=delete_cpd_log",data:a,success:function(t){"true"==t?e("#cpd-"+a["cpd-log-id"]).hide():alert("ERROR")},error:function(){alert("ERROR")}})}}),function(e){e.fn.goTo=function(){return e("html, body").animate({scrollTop:e(this).offset().top+"px"},"slow"),this}}(jQuery)});